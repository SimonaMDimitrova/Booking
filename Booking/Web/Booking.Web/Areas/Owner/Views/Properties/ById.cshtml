@model Booking.Web.ViewModels.PropertiesViewModels.PropertyByIdViewModel
@inject Booking.Services.IDictionariesService dictionariesService
@{
    this.ViewData["Title"] = this.Model.Name;
}

<h2 class="h2 text-center padding-headings">@this.ViewData["Title"]</h2>
<div id="carouselExampleControls" class="carousel slide" data-ride="carousel">
    <div class="carousel-inner">
        @{
            var index = 0;
            foreach (var image in Model.Images)
            {
                if (index == 0)
                {
                    <div class="carousel-item active">
                        <img class="d-block size" src="@image" alt="@Model.Name">
                    </div>
                }
                else
                {
                    <div class="carousel-item">
                        <img class="d-block size" src="@image" alt="@Model.Name">
                    </div>

                    if (Model.Offers.Any())
                    {
                        foreach (var offer in Model.Offers)
                        {
                            foreach (var offerImage in offer.Images)
                            {
                                <div class="carousel-item">
                                    <img class="d-block size" src="@offerImage" alt="@Model.Name">
                                </div>
                            }
                        }
                    }
                }

                index++;
            }
        }
    </div>
    <div class="controllers-carousel">
        <a class="" href="#carouselExampleControls" role="button" data-slide="prev">
            <span class="arrow-carousel" aria-hidden="true"><i class="fas fa-arrow-left"></i></span>
            <span class="sr-only"></span>
        </a>
        <a class="" href="#carouselExampleControls" role="button" data-slide="next">
            <span class="arrow-carousel" aria-hidden="true"><i class="fas fa-arrow-right"></i></span>
            <span class="sr-only">Next</span>
        </a>
    </div>
</div>
<hr />
<h3 class="text-center">Property information</h3>
<hr />
<p>@Model.Name</p>
<p>@Model.Description</p>
<p>@Model.Stars</p>
<p>@Model.Floors</p>
<p>@Model.Country</p>
<p>@Model.Town</p>
<p>@Model.Address</p>
<p>@Model.PropertyCategory</p>
<p>@Model.PropertyType</p>
<p>@Model.CurrencyCode</p>

<h3>Property facilities</h3>
<p>
    <ul>
        @foreach (var facility in Model.Facilities)
        {
            <li>@facility</li>
        }
    </ul>
</p>

<h3>Offers</h3>
@if (Model.Offers.Count() == 0)
{
    <p><a asp-controller="Offers" asp-action="Add" asp-route-id="@Model.Id"><i class="fas fa-plus-circle"></i> Add an offer</a></p>
}
else
{
    foreach (var offer in Model.Offers)
    {
        <p>@(offer.Price * offer.Guests) @Model.CurrencyCode</p>
        <p>@offer.ValidFrom</p>
        <p>@offer.ValidTo</p>
        <p>@offer.Guests</p>

        <p>------------------------------------</p>

        var facilities = dictionariesService.CreateFacilitiesDictionary(offer.OfferFacilities);
        foreach (var facility in facilities)
        {
            <p style="color: red;">@facility.Key</p>
            foreach (var facilityName in facility.Value)
            {
                <p>@facilityName</p>
            }
        }

        var rooms = dictionariesService.CreateBedTypeDictionary(offer.Rooms);
        foreach (var room in rooms)
        {
            <p>@room.Key</p>
            <p>@room.Value</p>
        }

        <a class="btn btn-primary" asp-action="Edit" asp-controller="Offers" asp-route-id="@offer.Id">Edit</a>
        <form method="post">
            <button class="btn btn-danger" asp-action="Delete" asp-controller="Offers" asp-route-id="@offer.Id">Delete</button>
        </form>
        <p>~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</p>
    }
}
